リアルタイム・カードバトルUI 実装要件定義書
1. プロジェクト概要
目的: リアルタイムで進行するトレーディングカードゲーム（TCG）において、ユーザーが直感的に状況を把握でき、かつ爽快感のある操作（UX）を提供するインターフェースを構築する。

ターゲット品質: 60fps以上の滑らかな動作、パーティクル（粒子）エフェクトの多用、3D/2Dのハイブリッド表現。

2. 技術スタック選定（推奨構成）
このレベルのUI/UXを実現するための現実的な技術構成です。

ゲームエンジン: Unity 6 (または 2022 LTS)

理由: モバイル向け2D/3Dハイブリッド開発のデファクトスタンダードであり、パーティクルシステムやシェーダーの資産が豊富。

言語: C#

UIフレームワーク: UGUI (Unity UI) + Canvas Group

理由: ワールド空間（3D空間）とスクリーン空間（2D画面）のUIを混在させるのに適しているため。

アニメーションライブラリ: DOTween Pro

理由: カードの移動、UIのポップアップ、数値のカウントアップなどをコードベースで制御するために必須。

エフェクト: Shuriken Particle System または VFX Graph

シェーダー: Shader Graph

理由: カードの「光る枠」「消滅演出」「ダメージ時の歪み」などのGPU処理に必要。

3. UI機能要件詳細
3.1. 画面レイアウト構成（Z軸レイヤー順）
画面を奥から手前へ以下のレイヤー構造で管理する。

Background Layer: 背景（3Dモデルまたは書き割り）。

Board Layer: ユニット配置スロット（3レーン）。

Unit Layer: 配置されたキャラクター（Live2Dまたは3Dモデル）。

Effect Layer (World): 攻撃時の火花、斬撃などのエフェクト。

HUD Layer: プレイヤーHP、MPゲージ、手札カード。

Overlay Layer: 「Active Response」等の暗転演出、カットイン。

System Layer: 設定ボタン、通信切断アイコン、デバッグ表示。

3.2. HUD（Heads-Up Display）機能
プレイヤー/敵ヒーロー情報

HPバー：即時変動ではなく、ダメージ分が赤く残ってから減る「遅延減少処理」を入れること。

ヒーローアーツ（必殺技）インジケーター：ポイント蓄積によるグロー（発光）エフェクト。

MP（マナ）ゲージ

要件: 時間経過でリニアに増加（例: 2秒で1MP）。

UX: 現在の手札で使用可能なカードがある場合、該当コストまで溜まった瞬間にSE（効果音）と光のエフェクトを発火。

手札エリア（Hand）

最大保持数: 5枚（想定）。

整列ロジック: カード枚数に応じて中央揃えで均等配置。

ドラッグ操作:

Hold: タップ長押しでカード詳細ポップアップ。

Drag: 画面中央へドラッグで「使用予兆」状態へ移行（スロットが光る）。

Drop: 有効なエリアで指を離すと召喚（Play）。無効エリアでは手札に戻るアニメーション。

3.3. 盤面（Board）相互作用
ユニットスロット（3レーン）

攻撃矢印（Attack Arrow）: 味方ユニットから敵ユニットへ伸びる矢印。

技術要件: ベジェ曲線（Bezier Curve）描画を用いて、ユニット間の距離に応じた曲線を動的に描画する。

衝突判定: 矢印が敵に到達した瞬間にダメージ計算と「ヒットストップ（数フレームの停止）」を入れる。

Active Response（割り込みフェーズ）UI * トリガー: アクションカード使用時。

演出要件:

背景を暗くし（Dim）、盤面の時間を停止させる。

中央に「ターンタイマーバー」を表示（10秒カウントダウン）。

カード同士を「チェーン」として線で繋ぐUIアニメーション。

状態遷移: 相互にカードを出し合うか、「パス」ボタンで解決フェーズへ移行。

3.4. フィードバック（Juice / Game Feel）
このUIの肝となる「手触り」の技術的定義です。

シェイク（Screen Shake）: ヒーローがダメージを受けた際、カメラ全体をXY軸にランダムに振動させる。

ヒットストップ: 強い攻撃が当たった瞬間、ゲーム全体の進行（TimeScale）を0.1秒ほど停止させ、重みを表現する。

ダメージフローティングテキスト: ダメージ数値を敵キャラクターの手前にポップさせ、重力に従って落下・フェードアウトさせる。

カードプレイ時のVFX: カードがユニットに実体化する際、単なるフェードインではなく、「召喚エフェクト（光の柱など）」を挟む。

4. 内部ロジックとデータ連携要件
UIを動かすための裏側の仕組みです。

4.1. ステートマシン（状態管理）
UIは以下のゲームステートを常に監視（Observe）し、表示を切り替える。

Init: 初期手札配布（マリガン）。

Main: 通常戦闘（リアルタイム）。

ActionPhase: アクションカード処理中（時間停止）。

Result: 勝敗決定。

4.2. イベント駆動設計（Observerパターン）
OnDamageTaken(int value) -> HPバー減少アニメーション、画面シェイク発火。

OnUnitSummoned(Unit unit) -> スロットにユニットPrefabを生成、着地エフェクト再生。

OnMpChanged(int currentMp) -> ゲージ変動、使用可能カードのハイライト更新。